#!/bin/bash

# Array of directories to copy
directories=(
  "."
  "packages/button"
  "packages/code-block"
)

# Loop through each directory
for dir in "${directories[@]}"; do
  echo "Copying node_modules from $dir"
  
  # Create a tar archive of the node_modules directory inside the container
  docker exec open-react-hub_docs-dev_1 tar -czf "/tmp/${dir//\//_}_node_modules.tar.gz" -C "/app/$dir" node_modules

  # Create the local directory if it doesn't exist
  mkdir -p "./$dir"

  # Copy the tar file from the container to your local machine
  docker cp "open-react-hub_docs-dev_1:/tmp/${dir//\//_}_node_modules.tar.gz" "./$dir/node_modules.tar.gz"

  # Extract the tar file locally
  tar -xzf "./$dir/node_modules.tar.gz" -C "./$dir"

  # Remove the tar file
  rm "./$dir/node_modules.tar.gz"

  echo "Finished copying node_modules from $dir"
  echo "--------------------"
done

echo "All node_modules directories have been copied."